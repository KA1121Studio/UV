<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>UV</title>
</head>
<body>
  <h2>Ultraviolet Proxy</h2>

  <input id="url" placeholder="https://example.com" style="width:300px;">
  <button onclick="go()">Go</button>

  <script src="/uv/uv.bundle.js"></script>
  <script src="/uv/uv.config.js"></script>
  
<script>
  async function go() {
    try {
      console.log('Go clicked');

      if ('serviceWorker' in navigator) {
        await navigator.serviceWorker.register('/uv/sw.js');
        console.log('SW registered');
      }

      const input = document.getElementById('url').value.trim();
      const url = input.startsWith('http') ? input : 'https://' + input;

      const encoded = Ultraviolet.codec.xor.encode(url);
      const target = __uv$config.prefix + encoded;

      console.log('Target:', target);
      location.href = target;

    } catch (e) {
      console.error('GO ERROR:', e);
      alert('GO ERROR: ' + e.message);
    }
  }
</script>


</body>
</html>
